function getComponentNames(component,node){node.children&&node.children().forEach(function(child){var name=child.name&&child.name();name&&!component.names[name]&&(component.names[name]=child.component||child),getComponentNames(component,child)})}function createComponentMethodProxy(method,methods){return function(){for(var i=0,n=arguments.length,$arguments=new Array(n);i<n;i++)$arguments[i]=arguments[i];return methods[method].apply(this,$arguments)}}function createComponentConstructor(tagName,methods){var C=function(a,b){var props={},children=[];if(Array.isArray(a)?children=a:"object"==typeof a&&(props=a,children=b||children),methods&&methods.constructor&&methods.constructor.call(this,props),this.props=this.props||props,this.tagName=tagName,this.names={},this.childNodes=[],"function"==typeof this.render){if(this.document=this.render(props),this.node=this.document.node,!this.document)throw new Error("Invalid component, component must return a node in the render function.");getComponentNames(this,this.document),children.length&&this.append(children)}},eventObject={tagName:tagName,constructor:C};for(method in methods)"constructor"!==method?C.prototype[method]=createComponentMethodProxy(method,methods):C.prototype[method]=methods[method];for(method in Component.prototype)void 0===C.prototype[method]&&(C.prototype[method]=Component.prototype[method]);for(var i=0,n=Component.onCreateListeners.length;i<n;i++)Component.onCreateListeners[i](eventObject);return C}function Component(){}Component.lib={},Component.function={},Component.onCreateListeners=[],Component.create=function(tagName,methods){if(Component.lib[tagName])throw new Error("Cannot create Component function: duplicate name '"+tagName+"'");return Component.lib[tagName]="function"==typeof methods?Component.create(tagName,{render:function(props){return methods(props)}}):createComponentConstructor(tagName,methods),Component.lib[tagName]},Component.createWrapper=function(el){function wrapMethod(method){return function(){for(var result,i=0,n=arguments.length,$arguments=new Array(n);i<n;i++)$arguments[i]=arguments[i];return void 0===(result=this.component[method].apply(this.component,$arguments))?this:result}}var keyGuard={},tempElement=el("div");for(var k in tempElement)"function"==typeof tempElement[k]&&(keyGuard[k]=!0);tempElement=void 0,Component.wrap=function(tagName,methods){var cTemp=el(tagName),render=methods.render,constructor=methods.constructor;for(var k in cTemp)"function"!=typeof cTemp[k]||methods[k]||keyGuard[k]||(methods[k]=wrapMethod(k));return methods.constructor=function(props){this.component=el(tagName),constructor&&constructor.call(this,props)},methods.render=function(props){return render.call(this,props)},methods}},Component.facade=function(methods){if(!Array.isArray(methods))throw"Invalid argument for Component.facade. The argument must be an array of methods.";methods.forEach(function(method){Component.prototype[method]||(Component.prototype[method]=Component.facade.method(method))})},Component.facade.method=function(method){return function(){for(var result,i=0,n=arguments.length,$arguments=new Array(n),root=this.document;i<n;i++)$arguments[i]=arguments[i];return void 0===(result=root[method].apply(root,$arguments))?this:result}},Component.find=function(name){var matches=[];for(var k in Component.lib)name.test(k)&&matches.push(k);return matches},Component.off=function(names,callback){function each(name,callback){var subscribers=Component.subscribers[name];subscribers.splice(subscribers.indexOf(callback),1)}for(var i=0,n=(names=names.toLowerCase().split(",")).length;i<n;i++)if(names[i]=names[i].trim(),names[i].length&&callback)each(names[i],callback);else for(;Component.subscribers[names[i]].length;)each(names[i],Component.subscribers[names[i]][0]);return Component},Component.onCreate=function(callback){return Component.onCreateListeners.push(callback),Component},Component.trigger=function(){var names,detail,subscribers=Component.subscribers;return"string"==typeof arguments[0]?(names=arguments[0],detail=arguments[1]||{}):(names=arguments[0].type,detail=arguments[0]),names=names.toLowerCase().split(","),Component.node.disabled||names.forEach(function(name){(name=name.trim()).length&&subscribers[name]&&subscribers[name].forEach(function(callback){callback(Object.assign({},detail,{type:name}))})}),Component},Component.prototype.after=function(target){return this.document.after.call(this,target),this},Component.prototype.append=function(children){return this.document.append(children),this.mapChildrenToNode(children),this},Component.prototype.appendTo=function(parentNode){return this.document.appendTo(parentNode),this.parentNode=parentNode,this},Component.prototype.before=function(target){return this.document.before.call(this,target),this},Component.prototype.closest=function(selector){return this.document.closest.call(this,selector)},Component.prototype.disable=function(){return this.document.disable(),this.document.childNodes.forEach(function(a){a.disable()}),this},Component.prototype.is=function(selector){return this.document.is.call(this,selector)},Component.prototype.enable=function(){return this.document.enable(),this.document.childNodes.forEach(function(a){a.enable()}),this},Component.prototype.mapChildrenToNode=function(children){for(var name,i=0,n=(children=Array.isArray(children)?children:[children]).length;i<n;i++)name=children[i].name&&children[i].name(),children[i].parentNode=this,name&&!this.node[name]&&(this.node[name]=children[i]);return[].push.apply(this.childNodes,children),this},Component.prototype.off=function(name,callback){var self=this;return void 0===this.subscribers&&(this.subscribers={}),name.toLowerCase().split(",").forEach(function(a){var i;if(a=a.trim(),void 0!==self.subscribers[a]){for(i=self.subscribers[a].indexOf(callback);-1!==i;)self.subscribers[a].splice(i,1),i=self.subscribers[a].indexOf(callback);if(void 0===callback)for(;self.subscribers[a].length;)self.subscribers[a].shift()}}),this},Component.prototype.on=function(name,callback){var self=this;return void 0===this.subscribers&&(this.subscribers={}),callback&&name.toLowerCase().split(",").forEach(function(a){(a=a.trim()).length&&(void 0===self.subscribers[a]&&(self.subscribers[a]=[]),-1===self.subscribers[a].indexOf(callback)&&self.subscribers[a].push(callback))}),this},Component.prototype.once=function(names,callback){function ref(e){callback.call(self,e),self.off(names,ref)}var self=this;return callback&&this.on(names,ref),this},Component.prototype.prepend=function(children){return this.mapChildrenToNode(children),this.document.prepend(children),this},Component.prototype.remove=function(){return this.document.remove.call(this),this},Component.prototype.trigger=function(){function filterNames(names){var split=names.split(","),filter=[];for(i=0,n=split.length;i<n;i++)split[i]=split[i].trim(),split[i].length&&self.subscribers[split[i]]&&filter.push(split[i]);return filter}var $names,self=this,names=arguments[0],object=arguments[1];return this.subscribers=this.subscribers||{},"string"==typeof names?(object=void 0!==object?object:{},$names=filterNames(names.toLowerCase())):$names=filterNames((object=arguments[0]).type.toLowerCase()),$names.forEach(function(name){self.subscribers[name].slice().forEach(function(callback){callback.call(self,object)})}),this},"undefined"!=typeof module&&module.exports&&(module.exports=Component);